<ng-container *ngIf="isBookForAnother">
  <div [formGroup]="rf" *ngIf="!isSameBooker">
    <div class="flex items-start justify-between">
      <div class='text-[17px] font-medium leading-[140%] text-primary-color'>
        {{ 'GUEST_INFORMATION' | translate | async }}
      </div>
      <div class="cursor-pointer" (click)="expansionPanel?.toggle()">
        <mat-icon
          class="text-primary-color">{{ expansionPanel?._getExpandedState() === 'expanded' ? 'expand_less' : 'expand_more' }}
        </mat-icon>
      </div>
    </div>
    <mat-expansion-panel #expansionPanel [expanded]="true">
      <div class='flex items-center gap-[12px] mb-[12px] sm:flex-col'>
        <div class='flex-1 sm:w-full'>
          <div
            class='text-[14px] font-medium leading-[150%] text-primary-color mb-[6px]'>{{ 'FIRST_NAME' | translate | async }}
            <span
              class='text-field-required'>*</span></div>
          <div class=''>
            <app-input
              [customClass]="'!h-[40px] !rounded-[10px] border border-border-color text-primary-color'"
              [isRequired]='true'
              [control]="rf?.get('firstName')"
              formControlName='firstName'
              type='text'
            >
              <app-form-error *ngIf="rf?.get('firstName').hasError('required') && rf?.get('firstName').touched">
                {{ 'FIRST_NAME' | translate | async }} {{ 'IS_REQUIRED' | translate | async }}
              </app-form-error>
            </app-input>
          </div>
        </div>
        <div class='flex-1 sm:w-full'>
          <div
            class='text-[14px] font-medium leading-[150%] text-primary-color mb-[6px]'>{{ 'LAST_NAME' | translate | async }}
            <span
              class='text-field-required'>*</span></div>
          <div class=''>
            <app-input
              [customClass]="'!h-[40px] !rounded-[10px] border border-border-color text-primary-color'"
              [isRequired]='true'
              [control]="rf?.get('lastName')"
              formControlName='lastName'
              type='text'
            >
              <app-form-error *ngIf="rf?.get('lastName').hasError('required') && rf?.get('lastName').touched">
                {{ 'LAST_NAME' | translate | async }} {{ 'IS_REQUIRED' | translate | async }}
              </app-form-error>
            </app-input>
          </div>
        </div>
      </div>
      <div class='flex items-center gap-[12px] mb-[12px] sm:flex-col'>
        <div class='flex-1 sm:w-full'>
          <div
            class='text-[14px] font-medium leading-[150%] text-primary-color mb-[6px]'>{{ 'EMAIL' | translate | async }}
            <span
              class='text-field-required'>*</span></div>
          <div class=''>
            <app-input
              [customClass]="'!h-[40px] !rounded-[10px] border border-border-color text-primary-color'"
              [isRequired]='true'
              [control]="rf?.get('email')"
              formControlName='email'
              type='email'
            >
              <app-form-error *ngIf="rf?.get('email').hasError('required') && rf?.get('email').touched">
                {{ 'EMAIL' | translate | async }} {{ 'IS_REQUIRED' | translate | async }}
              </app-form-error>
              <app-form-error *ngIf="rf?.get('email').hasError('email') && rf?.get('email').touched">
                {{ 'EMAIL' | translate | async }} {{ 'IS_NOT_VALID' | translate | async }}
              </app-form-error>
            </app-input>
          </div>
        </div>
        <div class='flex-1 sm:w-full'>
          <div
            class='text-[14px] font-medium leading-[150%] text-primary-color mb-[6px]'>{{ 'PHONE_NUMBER' | translate | async }}
            <span
              class='text-field-required'>*</span></div>
          <div class=''>
            <app-input-custom-phone-number
              [allItems]='countriesPhone$ | async'
              [isRequired]='true'
              [metadata]="true"
              [control]="rf?.get('phoneNumber')"
              [customClass]="'!h-[40px] !rounded-[10px] border border-border-color text-primary-color'"
              formControlName='phoneNumber'
            >
              <app-form-error
                *ngIf="(rf?.get('phoneNumber').hasError('required') || rf?.get('phoneNumber').hasError('phoneNumberRequired')) && rf?.get('phoneNumber').touched">
                {{ 'PHONE_NUMBER' | translate | async }} {{ 'IS_REQUIRED' | translate | async }}
              </app-form-error>
            </app-input-custom-phone-number>
          </div>
        </div>
      </div>
      <div class='mb-[12px]'>
        <div
          class='text-[14px] font-medium leading-[150%] text-primary-color mb-[6px]'>{{ 'ADDRESS' | translate | async }}
          <span
            *ngIf='mandatoryAddressMainGuest?.address'
            class='text-field-required'>*</span></div>
        <div class=''>
          <app-input
            [customClass]="'!h-[40px] !rounded-[10px] border border-border-color text-primary-color'"
            [isRequired]='mandatoryAddressMainGuest?.address'
            [control]="rf?.get('address')"
            formControlName='address'
            type='text'
            [maxLength]="80"
          >
            <app-form-error *ngIf="rf?.get('address').hasError('required') && rf?.get('address').touched">
              {{ 'ADDRESS' | translate | async }} {{ 'IS_REQUIRED' | translate | async }}
            </app-form-error>
          </app-input>
        </div>
      </div>
      <div class='flex items-center gap-[12px] mb-[12px] sm:flex-col'>
        <div class='flex-1 sm:w-full'>
          <div
            class='text-[14px] font-medium leading-[150%] text-primary-color mb-[6px]'>{{ 'CITY' | translate | async }}
            <span
              *ngIf='mandatoryAddressMainGuest?.city'
              class='text-field-required'>*</span></div>
          <div class=''>
            <app-input
              [customClass]="'!h-[40px] !rounded-[10px] border border-border-color text-primary-color'"
              [isRequired]='true'
              [control]="rf?.get('city')"
              formControlName='city'
              type='text'
              [maxLength]="40"
            >
              <app-form-error *ngIf="rf?.get('city').hasError('required') && rf?.get('city').touched">
                {{ 'CITY' | translate | async }} {{ 'IS_REQUIRED' | translate | async }}
              </app-form-error>
            </app-input>
          </div>
        </div>
        <!--        <div class='flex-1 sm:w-full'>-->
        <!--          <div-->
        <!--            class='text-[14px] font-medium leading-[150%] text-primary-color mb-[6px]'>{{'STATE' | translate | async}}</div>-->
        <!--          <div class=''>-->
        <!--            <app-input-->
        <!--              [customClass]="'!h-[40px] !rounded-[10px] border border-border-color text-primary-color'"-->
        <!--              [control]="rf?.get('state')"-->
        <!--              formControlName='state'-->
        <!--              type='text'-->
        <!--            ></app-input>-->
        <!--          </div>-->
        <!--        </div>-->
      </div>
      <div class='flex items-center gap-[12px] mb-[12px] sm:flex-col'>
        <div class='flex-1 sm:w-full'>
          <div
            class='text-[14px] font-medium leading-[150%] text-primary-color mb-[6px]'>{{ 'COUNTRY' | translate | async }}
          </div>
          <div class=''>
            <app-select-single-control-country
              [allItems]='countriesParse$ | async'
              [control]="rf?.get('country')"
              [customClass]="'!h-[40px] !rounded-[10px] border border-border-color text-primary-color'"
              formControlName='country'
            >
            </app-select-single-control-country>
          </div>
        </div>
        <div class='flex-1 sm:w-full'>
          <div class='text-[14px] font-medium leading-[150%] text-primary-color mb-[6px]'>
            {{ 'POSTAL_CODE' | translate | async }}
            <span
              *ngIf='mandatoryAddressMainGuest?.postalCode'
              class='text-field-required'>*</span>
          </div>
          <div class=''>
            <app-input
              [customClass]="'!h-[40px] !rounded-[10px] border border-border-color text-primary-color'"
              [control]="rf?.get('postalCode')"
              formControlName='postalCode'
              type='text'
              [maxLength]="15"
            >
              <app-form-error *ngIf="rf?.get('postalCode').hasError('required') && rf?.get('postalCode').touched">
                {{ 'POSTAL_CODE' | translate | async }} {{ 'IS_REQUIRED' | translate | async }}
              </app-form-error>
            </app-input>
          </div>
        </div>
      </div>
    </mat-expansion-panel>
  </div>
  <div class='my-[28px] border-b border-border-color sm:my-[16px]'></div>
</ng-container>
<!-- Additional guest -->
<div *ngIf='(+totalAdults + +totalChildren) > 1'>
  <div class="flex items-start justify-between">
    <div class='text-[17px] font-medium leading-[140%] text-primary-color'>
      {{ 'ADDITIONAL_GUEST' | translate | async }}
    </div>
    <div class="cursor-pointer" (click)="expansionPanel2?.toggle()">
      <mat-icon
        class="text-primary-color">{{ expansionPanel2?._getExpandedState() === 'expanded' ? 'expand_less' : 'expand_more' }}
      </mat-icon>
    </div>
  </div>

  <mat-expansion-panel #expansionPanel2 [expanded]="true">
    <div class=''>

      <ng-container *ngFor="let item of reservationList; let index = index; let lastReservation = last">
        <ng-container *ngIf="additionalGuestListFrm(index) as rfGuests">
          <ng-container *ngIf="rfGuests?.controls?.length > 0">
            <div class="p-[12px] rounded-[16px] bg-background-primary-color"
                 [ngClass]="{'mb-[16px]' : !lastReservation}">
              <div class="flex items-center gap-[4px] mb-[24px]">
                <div class="text-[14px] font-medium leading-[19.6px] text-primary-color sm:text-[12px]">
          <span
            class="px-[3px] py-[4px] rounded-[4px] text-[14px] font-normal sm:text-[12px]"
            *ngIf="reservationList?.length > 1"
            [style.background-color]="colorPrimary | hexToRgba: 0.3"
          > #{{ index + 1 }}.</span>
                  {{ !(item?.bookingFlow === bookingFlow.LowestPrice && isLowestPriceOpaque) ? item?.rfc?.name : ('NO_PREFERENCES_OR_FEATURES_GUARANTEED' | translate | async) }}
                </div>

                <div class="text-[14px] leading-[19.6px] font-light text-primary-color sm:text-[12px]">
                  {{ 'FOR' | translate | async }} {{ item?.adult }} {{ (item?.adult > 1 ? 'ADULTS' : 'ADULT') | translate | async }}
                  <span class="text-[14px] leading-[19.6px] font-light text-primary-color sm:text-[12px]"
                        *ngIf="item?.childrenAgeList?.length > 0">, {{ item?.childrenAgeList?.length }} {{ (item?.childrenAgeList?.length > 1 ? 'CHILDREN' : 'CHILD') | translate | async }}</span>
                </div>
              </div>

              <ng-container *ngFor="let guest of rfGuests?.controls; index as i; let last = last">
                <div
                  class='flex items-start gap-[12px] sm:flex-col' [formGroup]='guest | parseFormGroup'
                  [ngClass]="{'mb-[12px]' : !last}"
                >
                  <div class='flex-1 sm:w-full'>
                    <div
                      class='text-[14px] font-medium leading-[120%] text-primary-color mb-[4px]'>{{ 'FIRST_NAME' | translate | async }}
                      <ng-container
                        *ngIf="(reservationList | getOrdinaryGuest: index : rfGuests?.value : i) as guestInfo">
                        ({{ guestInfo?.key | translate | async }} {{ guestInfo?.ordinary + 2 }})
                      </ng-container>
                      <span class='text-field-required'>*</span>
                    </div>
                    <app-input
                      type='text'
                      [maxLength]='50'
                      formControlName='firstName'
                      [control]="guest?.get('firstName')"
                      [customClass]="'!h-[40px] !rounded-[10px] border border-border-color text-primary-color'"
                      (keyup)="changeValue(guest?.get('firstName')?.value, i, rfGuests)"
                    >
                      <app-form-error
                        *ngIf="guest?.get('firstName')?.hasError('required') && guest?.get('firstName').touched">
                        {{ 'FIRST_NAME' | translate | async }} {{ 'IS_REQUIRED' | translate | async }}
                      </app-form-error>
                    </app-input>
                  </div>
                  <div class='flex-1 sm:w-full'>
                    <div class='text-[14px] font-medium leading-[120%] text-primary-color mb-[4px]'>
                      {{ 'LAST_NAME' | translate | async }}
                      <span class='text-field-required'>*</span>
                    </div>
                    <app-input
                      [maxLength]='50'
                      [control]="guest?.get('lastName')"
                      [customClass]="'!h-[40px] !rounded-[10px] border border-border-color text-primary-color'"
                      formControlName='lastName'
                      type='text'
                    >
                      <app-form-error
                        *ngIf="guest?.get('lastName')?.hasError('required') && guest?.get('lastName').touched">
                        {{ 'LAST_NAME' | translate | async }} {{ 'IS_REQUIRED' | translate | async }}
                      </app-form-error>
                    </app-input>
                  </div>
                </div>
              </ng-container>
            </div>
          </ng-container>
        </ng-container>
      </ng-container>
    </div>
  </mat-expansion-panel>

  <div class='my-[28px] border-b border-border-color sm:my-[16px]'></div>
</div>

