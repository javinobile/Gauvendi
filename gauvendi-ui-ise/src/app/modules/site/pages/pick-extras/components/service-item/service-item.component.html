@if (petSurchargeAmenity$ | async) {
  <div
    class="h-[200px] bg-popover-background-color rounded-[16px] shadow-extras overflow-hidden flex flex-col justify-between"
    [ngClass]="{ 'border border-hotel-primary-color': (unit === itemUnit.Item && amount > 0) || (unit !== itemUnit.Item && isSelected) || isMandatory || isIncluded }"
  >
    <div class="flex items-stretch h-[calc(100%-58px)] relative">
      <div class="w-[60%] p-[16px] flex flex-col" [class.pt-10]="(unit === itemUnit.Item && amount > 0) || (unit !== itemUnit.Item && isSelected) || isMandatory || isPetSurchargeExcluded()">
        <div
          #titleEle
          class="text-[14px] font-medium leading-[120%] text-primary-color mb-[4px] line-clamp-2 min-h-fit"
          appCustomTooltip
          [isDisabled]="titleEle?.scrollHeight <= titleEle.offsetHeight || isMobile"
          [tooltipMessage]="title"
        >
          {{ title }}
        </div>
        <div class="text-[12px] font-light leading-[140%] text-secondary-color max-h-[80px] overflow-y-auto">{{ customizeDescription }}</div>
      </div>
      <div class="flex-1">
        <div
          class="bg-no-repeat bg-cover bg-center w-full h-full rounded-tr-[16px] rtl:rounded-br-[8px]"
          [ngClass]="{
            'ltr:rounded-tl-[0px] rtl:rounded-tr-[0px]': isMandatory || isPetSurchargeExcluded()
          }"
          [ngStyle]="{ 'background-image': image | parseImageUrl }"
        ></div>
        <ng-container *ngIf="unit === itemUnit.Item && amount > 0">
          <div
            class="absolute ltr:left-0 rtl:right-0 top-0 flex items-center justify-center text-[12px] w-fit min-w-[60%] font-medium leading-[140%] text-button-normal-color bg-button-normal-background-color h-[32px] px-[8px]"
          >
            x{{ amount }}
          </div>
        </ng-container>
        <ng-container *ngIf="unit !== itemUnit.Item && isSelected">
          <div
            class="absolute ltr:left-0 rtl:right-0 top-0 flex items-center justify-center text-[12px] w-fit min-w-[60%] font-medium leading-[140%] text-button-normal-color bg-button-normal-background-color h-[32px] px-[8px]"
          >
            {{ 'SELECTED' | translate | async }}
          </div>
        </ng-container>
        <ng-container *ngIf="isMandatory || isPetSurchargeExcluded()">
          <div
            class="absolute ltr:left-0 rtl:right-0 top-0 flex items-center justify-center text-[12px] w-fit min-w-[60%] font-medium leading-[140%] text-button-normal-color bg-button-normal-background-color h-[32px] px-[8px]"
          >
            {{ 'FIXED_FEE' | translate | async }}
          </div>
        </ng-container>
      </div>
    </div>
    <div [ngClass]="{ 'bg-button-normal-background-color': isIncluded }" class="border-t border-border-color h-[58px] flex items-center justify-between py-[12px] px-[16px]">
      <ng-container *ngIf="isIncluded; else tplDefault">
        @if (isPetSurchargeExcluded()) {
          <ng-container [ngTemplateOutlet]="tplDefault"></ng-container>
        } @else {
          <div class="text-button-normal-color bg-service-included-fill w-full text-[12px] font-medium leading-[140%] h-[28px] rounded-[12px] flex items-center justify-center">
            {{ 'INCLUDED' | translate | async }}
          </div>
        }
      </ng-container>
    </div>
  </div>
}

<ng-template #tplDefault>
  <div [class.text-button-normal-color]="isIncluded" [class.text-primary-color]="!isIncluded">
    <div class="text-[20px] font-medium leading-[120%]">{{ price }}</div>
    <div class="text-[10px] font-light leading-[140%]">{{ unit | parsePricingModel: code() | translate | async }}</div>
  </div>
  <ng-container *ngIf="isMandatory">
    <!-- Do nothing -->
  </ng-container>
  <ng-container *ngIf="!isMandatory && !isPetSurchargeExcluded()">
    <ng-container *ngIf="unit !== itemUnit.Item; else tplNumericBox">
      <ng-container *ngIf="!isSelected; else tplRemove">
        <button
          (click)="handleToggle('Add')"
          class="h-[28px] px-[24px] rounded-[12px] bg-button-hover-background-color text-button-hover-color text-[12px] font-medium leading-[140%] flex items-center justify-center hover:opacity-80"
        >
          {{ 'SELECT' | translate | async }}
        </button>
      </ng-container>
    </ng-container>
  </ng-container>
</ng-template>

<ng-template #tplNumericBox>
  <app-numeric-step
    [customClass]="'!w-[84px] !h-[28px] !text-button-hover-color !bg-button-hover-background-color !rounded-[12px] !border-button-hover-background-color'"
    [customTextClass]="'!text-button-hover-color'"
    [min]="0"
    [formControl]="control"
    (valueChange)="changeValue()"
  ></app-numeric-step>
</ng-template>

<ng-template #tplRemove>
  <button
    (click)="handleToggle('Remove')"
    class="h-[28px] px-[24px] rounded-[12px] text-outline-button-normal-color bg-outline-button-normal-background-color border border-outline-button-normal-color text-[12px] font-medium leading-[140%] flex gap-[4px] items-center justify-center hover:opacity-80"
  >
    <img loading="lazy" src="assets/icons/remove.svg" appFilterSvg [color]="outlineButtonText$ | async" alt="Remove" />
    <div class="">{{ 'REMOVE' | translate | async }}</div>
  </button>
</ng-template>
